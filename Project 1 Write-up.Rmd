---
title: "DATS6101 Project 1"
author: Group 5
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
date: "2023-03-20"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = F, message = F)
options(scientific = T, digits = 3)
```

```{r init, include = FALSE}
# loading in libraries
library(ezids)
library(tidyverse)
library(readr)
library(ggplot2)
library(stringr)
library(gridExtra)
```

```{r, include = FALSE}
# loading in dataset
diabetes <- read.csv("diabetes_binary_5050split_health_indicators_BRFSS2015.csv")
str(diabetes)

# renaming some longer variables
diabetes <- diabetes %>%
    rename("diabetes"= Diabetes_binary)
diabetes <- diabetes %>%
  rename("heart_dis" = HeartDiseaseorAttack)
diabetes <- diabetes %>%
  rename("hvy_alc" = HvyAlcoholConsump)

# storing categorical variables as factor
diabetes$diabetes <- as.factor(diabetes$diabetes)
diabetes$HighBP <- as.factor(diabetes$HighBP)
diabetes$HighChol <- as.factor(diabetes$HighChol)
diabetes$CholCheck <- as.factor(diabetes$CholCheck)
diabetes$Smoker <- as.factor(diabetes$Smoker)
diabetes$Stroke <- as.factor(diabetes$Stroke)
diabetes$NoDocbcCost <- as.factor(diabetes$NoDocbcCost)
diabetes$heart_dis <- as.factor(diabetes$heart_dis)
diabetes$PhysActivity <- as.factor(diabetes$PhysActivity)
diabetes$Fruits <- as.factor(diabetes$Fruits)
diabetes$Veggies <- as.factor(diabetes$Veggies)
diabetes$hvy_alc <- as.factor(diabetes$hvy_alc)
diabetes$DiffWalk <- as.factor(diabetes$DiffWalk)
diabetes$Sex <- as.factor(diabetes$Sex)
diabetes$GenHlth <- as.factor(diabetes$GenHlth)
diabetes$AnyHealthcare <- as.factor(diabetes$AnyHealthcare)
diabetes$Education <- as.factor(diabetes$Education)
diabetes$Income <- as.factor(diabetes$Income)

```

```{r, include = FALSE}
# colorblind color palettes

# The palette with grey:
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

# The palette with black:
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

# To use for fills, add
  #scale_fill_manual(values=cbPalette)

# To use for line and point colors, add
  #scale_colour_manual(values=cbPalette)
```

# Examination of Risk Factors Strongly Associated with the Likelihood of Developing Diabetes in the United States

**Summary**
Diabetes is one of the most common chronic diseases in the United States. According to the Centers for Disease Control and Prevention (CDC), 34.2 million Americans have diabetes and 88 million have pre-diabetes (2018).For Project 1, our group looked at a data set from [Kaggle](https://www.kaggle.com/datasets/alexteboul/diabetes-health-indicators-dataset?select=diabetes_012_health_indicators_BRFSS2015.csv) containing pre-diabetes & diabetes-related health-risks. We want to assess which risk factors were most associated with diabetes. Through exploratory data analysis (EDA), we had more insights into the data and some possibilities we could explore when modelling for project 2. 

#### 1. Background

Diabetes is a common chronic condition that affects millions of people. In 2018, the Center for Disease Control and Prevention (CDC) reported 34.2 million Americans have diabetes and 88 million have pre-diabetes^[1]. It is also the most expensive chronic condition in the United States, with $1 out of every $4 in health care costs spent on treating people with diabetes^[2]. The estimated total financial cost of diabetes is $327 billion dollars in 2017^[3].

*What is diabetes?* It is a health condition that causes low insulin level in humans– that’s the hormone that helps us break down glucose(sugar) into energy. This cause diabetics to have high level of sugar in their blood. Many complications can result from diabetes, including heart disease, vision loss, kidney disease, limb amputation, etc.^[5] 


#### 2. Data
#### 3. EDA

```{r, include = FALSE}
# subseting the data between people who have pre/diabetes and people who do not
diabts1 <- subset(diabetes, diabetes == 1)
diabts0 <- subset(diabetes, diabetes == 0)
```

**First, we ran some summary statistics for the data set:**

```{r, comment = ""}
summary(diabetes)
```
Since most of our features are categorical, running summary statistics will not be very helpful in seeing what is going on. We decided that graphs and plots, particularly bar graphs and histograms are much more effective in portraying what the data looks like and what are the potential things we could look at. 

**Graphs for each variable/feature**

**For high blood pressure**

Among people who have high blood pressure, more people report to have prediabetes or diabetes than people who do not. 
Within people without high blood pressure, fewer respondants have pre-diabetes/diabetes compare to participants who do not.

```{r}
library(ggplot2)
highbp1 <- ggplot(data = diabetes, aes(x = factor(HighBP), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color = "black")+
      labs(title = "High blood pressure distribution", x = "have high blood pressure (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes")) +
      scale_fill_manual(values=cbPalette)
    
highbp1
```

**For high cholesterol**

Similarly, within participants with high cholesterol, there are more with pre-diabetes/diabetes than without. Within respondants without high cholesterol, there are fewer people with pre-diabetes/diabetes than without.

``` {r}
highchol1 <- ggplot(data = diabetes, aes(x = factor(HighChol), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color = "black")+
      labs(title = "High cholesterol level distribution", x = "have high cholesterol (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes")) +
      scale_fill_manual(values=cbPalette)
    
highchol1

```

**For CholCheck (if the person has checked for cholesterol level within the past 5 years)**

Most people have had their cholesterol level checked within the past 5 years. For those who have checked, more people reported having pre-diabetes/diabetes.

```{r}
cholcheck1 <- ggplot(data = diabetes, aes(x = factor(CholCheck), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color = "black")+
      labs(title = "Cholesterol-check within 5 years distribution", x = "checked (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes")) +
      scale_fill_manual(values=cbPalette)
    
cholcheck1

```

**For BMI levels:**

As we can see on both the box plot and the histograms, there is a good number of people who have BMI of 30 and above within people with pre-diabetes/diabetes and without. Participants with pre-diabetes/diabetes have higher BMI overall. Just as a note, a BMI of 25-29.9 is considered overweight, and 30 and above is considered obese. 

```{r}
bmi <- ggplot(data = diabetes, aes(x = BMI, fill=factor(diabetes))) +
      geom_boxplot(color = "black")+
      labs(title = "Distribution of BMI", x = "BMI") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5),
            axis.text.y = element_blank(),
            axis.ticks.y = element_blank())+
      guides(fill = guide_legend(title = "Diabetes")) +
      scale_fill_manual(values=cbPalette)
bmi
```

```{r}
bmi1 <- ggplot(data = diabts1, aes(x = BMI)) +
      geom_histogram(width = 0.5, color="black", fill="plum3")+
      labs(title = "Distribution of BMI among \npeople with pre/diabetes", x = "BMI") +
      theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5))

bmi0 <- ggplot(data = diabts0, aes(x = BMI)) +
      geom_histogram(width = 0.5, color="black", fill="plum3")+
      labs(title = "Distribution of BMI among \npeople without pre/diabetes", x = "BMI") +
      theme(plot.title = element_text(size = 12, face = "bold", hjust = 0.5))

grid.arrange(bmi1, bmi0, nrow = 1, ncol = 2)
```


**For Smoker:**

Among respondents that smoked, more people also reported having pre-diabetes/diabetes than those without. Within people who do not smoke, fewer reported having pre-diabetes/diabetes than without.

```{r}
smoker1 <- ggplot(data = diabetes, aes(x = factor(Smoker), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color = "black")+
      labs(title = "Distribution of smokers", x = "smoking (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes")) +
      scale_fill_manual(values=cbPalette)
    
smoker1
```

**For Stroke:**

Most survey participants did not report having had a stroke. Within those who did, more also reported having pre-diabetes/diabetes. 

```{r}
stroke1 <- ggplot(data = diabetes, aes(x = factor(Stroke), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color = "black")+
      labs(title = "Stroke distribution", x = "have had a stroke (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes")) +
     scale_fill_manual(values=cbPalette)
    
stroke1
```

**For Heart Disease/Attack**

Within people reported having a heart disease or having had a heart attack, more people also reported having pre-diabetes/diabetes than without. 

```{r}
heart_dis1 <- ggplot(data = diabetes, aes(x = factor(heart_dis), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color = "black")+
      labs(title = "Heart disease/attack distribution", x = "have heart disease/attack (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes")) +
      scale_fill_manual(values=cbPalette)
    
heart_dis1
```

**For PhysActivity (if they've had any physical activity outside of work the past 30 days)**

For those who *did not have* any physical activity outside of their job, more people reported having pre-diabetes/diabetes than without. Within those who *did have* physical activity in the past 30 days, fewer reported having pre-diabetes/diabetes. 

```{r}
phys1 <- ggplot(data = diabetes, aes(x = factor(PhysActivity), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color = "black")+
      labs(title = "Physical activity distribution", x = "physical activity within 30 days (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes")) +
      scale_fill_manual(values=cbPalette)
    
phys1
```

**For Fruits (daily consumption of fruits)**

Among participants who *did not have* fruits in their daily diet, a higher number of people reported having pre-diabetes/diabetes compared to those who did not. Fewer people with pre-diabetes/diabetes have fruits daily in their diet compared to people who do not have pre-diabetes/diabetes.

```{r}
fruits1 <- ggplot(data = diabetes, aes(x = factor(Fruits), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color = "black")+
      labs(title = "Daily fruits consumption distribution", x = "had fruits (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes")) +
      scale_fill_manual(values=cbPalette)
    
fruits1
```

**For Veggies**

Within respondents who *did not have* vegetables daily, more participants reported having pre-diabetes/diabetes than without. Fewer people with pre-diabetes/diabetes have vegetables in their daily diet compared to people who did not have pre-diabetes/diabetes.

```{r}
veg1 <- ggplot(data = diabetes, aes(x = factor(Veggies), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color = "black")+
      labs(title = "Daily consumption of vegetables", x = "had vegetables (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes")) +
      scale_fill_manual(values=cbPalette)
    
veg1
```

**For HvyAlcohol (adult men >= 14 drinks/week, adult women >= 7 drinks/week):**

Most participants reported not having high alcohol consumption. Within those who *do* consume a lot of alcohol, fewer reported having pre-diabetes/diabetes than without. Among those who *do not* drink heavily, more people reported having pre-diabetes/diabetes.

```{r}
library(ggplot2)
hvyalc1 <- ggplot(data = diabetes, aes(x = factor(hvy_alc), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color = "black")+
      labs(title = "High alcohol consumption distribution", x = "high-alcohol consumption (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes")) +
      scale_fill_manual(values=cbPalette)
    
hvyalc1
```


**For AnyHealthcare (if the participant reported having any health insurance): **

Most participants had health insurance. The distribution is mostly equal between people who have pre-diabetes/diabetes and people who do not. Within people who *did not have* insurance, fewer had pre-diabetes/diabetes than without.

```{r}
library(ggplot2)
any_health1 <- ggplot(data = diabetes, aes(x = factor(AnyHealthcare), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color="black")+
      labs(title = "Health insurance availability", x = "have insurance (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes"))+
      scale_fill_manual(values=cbPalette)
any_health1
```


**For NoDocbcCost (needed to see a doctor but did not due to cost in the past 12 months):**

Among people who had to refuse a doctor visit due to the high cost, more reported having pre-diabetes/diabetes than without. 

```{r}
library(ggplot2)
nodoc1 <- ggplot(data = diabetes, aes(x = factor(NoDocbcCost), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color="black")+
      labs(title = "Refusal of doctor visits due to cost", x = "visited doctor (0=yes, 1=no)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes"))+
      scale_fill_manual(values=cbPalette)
nodoc1
```

**For GenHlth (rating general health level from 1 (excellent) through 5 (poor): **

People with pre-diabetes/diabetes generally rated their health lower than that of people without pre-diabetes/diabetes.


```{r}
genhlth1 <- ggplot(data = diabetes, aes(x = GenHlth, fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color="black")+
      labs(title = "Distribution of self-rated general health level (1 to 5)", x = "general health level") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes"))+
      scale_fill_manual(values=cbPalette)
genhlth1
```

**For MentHlth (number of days with poor mental health, from 1 to 30 days):**

A majority of participants reported not having any poor mental health days within the past 30 days. A higher number of people with pre-diabetes/diabetes reported having 30 days of bad mental health compared to people without pre-diabetes/diabetes.

```{r}
mentalh1 <- ggplot(data = diabts1, aes(x = MentHlth)) +
      geom_histogram(width = 0.5, color="black", fill="lightsteelblue")+
      labs(title = "Distribution of poor mental health days \namong people with pre/diabetes", x = "no. of days") +
      theme(plot.title = element_text(size = 10, face = "bold", hjust = 0.5))
mentalh1

mentalh0 <- ggplot(data = diabts0, aes(x = MentHlth)) +
      geom_histogram(width = 0.5, color="black", fill="lightsteelblue")+
      labs(title = "Distribution of poor mental health days \namong people without pre/diabetes", x = "no. of days") +
      theme(plot.title = element_text(size = 10, face = "bold", hjust = 0.5))
mentalh0

grid.arrange(mentalh1, mentalh0, nrow = 1, ncol = 2)
```

**For PhysHlth (days with physical injuries, from 1 to 30 days):**

Similarly, more participants with pre-diabetes/diabetes reported having 30 days of physical injury(ies) compared to respondents who did not have pre-diabetes/diabetes.

```{r}
physh1 <- ggplot(data = diabts1, aes(x = PhysHlth)) +
      geom_histogram(width = 0.5, color="black", fill="plum3")+
      labs(title = "Distribution of days with physical injuries \namong people with pre/diabetes", x = "no. of days") +
      theme(plot.title = element_text(size = 10, face = "bold", hjust = 0.5))


physh0 <- ggplot(data = diabts0, aes(x = PhysHlth)) +
      geom_histogram(width = 0.5, color="black", fill="plum3")+
      labs(title = "Distribution of days with physical injuries \namong people without pre/diabetes", x = "no. of days") +
      theme(plot.title = element_text(size = 10, face = "bold", hjust = 0.5))


grid.arrange(physh1, physh0, nrow = 1, ncol = 2)
```

**For DiffWalk (if participant had serious difficulty walking/climbing stairs):**

Among participants who had difficulty walking or climbing stairs, more reported having pre-diabetes/diabetes compared to those who do not. Within respondents who did not have mobility problems, fewer people had pre-diabetes/diabetes. 

```{r}
diffwalk1 <- ggplot(data = diabetes, aes(x = factor(DiffWalk), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color="black")+
      labs(title = "Difficulty walking/climbing stairs distribution", x = "have difficulty walking (0=no, 1=yes)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes"))+
      scale_fill_manual(values=cbPalette)
diffwalk1
```

**For Sex (0 = female, 1 = male):**

More women than men are in this data. More women reported having pre-diabetes/diabetes than men. 

```{r}
sex1 <- ggplot(data = diabetes, aes(x = factor(Sex), fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color="black")+
      labs(title = "Distribution of sex", x = "sex (0 = female, 1 = male)") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes"))+
      scale_fill_manual(values=cbPalette)
sex1
```

**For Age (separated into 13 age categories):**

Older age groups have more diabetic participants than younger age groups; from 55 years onwards. 

```{r}
age1 <- ggplot(data = diabetes, aes(x = Age, fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color="black")+
      labs(title = "Distribution of age groups", x = "age groups") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes"))+
      scale_fill_manual(values=cbPalette)
age1
```

**For Education (separated into 6 education levels):**

At education levels 2 through 5 (meaning from grades 1 through 1-3 years of college), we see more participants with pre-diabetes/diabetes than without. At level 6 (meaning they graduated college), we see fewer participants with pre-diabetes/diabetes than without. 

```{r}
edu1 <- ggplot(data = diabetes, aes(x = Education, fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color="black")+
      labs(title = "Distribution of education levels", x = "education level") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes"))+
      scale_fill_manual(values=cbPalette)
edu1
```

**For Income (income levels from 1 to 8, 1 is <= $10k and 8 is $75k+):**

At lower income levels 1 through 6, more people reported having pre-diabetes/diabetes than without. At income levels 7 and 8, fewer people had pre-diabetes/diabetes compared to people without. 


```{r}
income1 <- ggplot(data = diabetes, aes(x = Income, fill=factor(diabetes))) +
      geom_bar(stat = "count", position=position_dodge(),width = 0.5, color="black")+
      labs(title = "Distribution of income levels", x = "income level") +
      theme(plot.title = element_text(face = "bold", hjust = 0.5))+
      guides(fill = guide_legend(title = "Diabetes"))+
      scale_fill_manual(values=cbPalette)
income1
```

Again, as the data is mostly categorical, we want to run chi-square tests to check for correlations.

```{r}
chisq.test(diabetes$diabetes, diabetes$HighBP)
```

```{r}
chisq.test(diabetes$diabetes, diabetes$HighChol)
```

```{r}
chisq.test(diabetes$diabetes, diabetes$CholCheck)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$Smoker)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$heart_dis)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$PhysActivity)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$Fruits)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$Veggies)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$hvy_alc)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$DiffWalk)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$Sex)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$AnyHealthcare)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$NoDocbcCost)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$GenHlth)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$MentHlth)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$Education)
```
```{r}
chisq.test(diabetes$diabetes, diabetes$Income)
```

#### 4. Conclusion

##### References

1.Centers for Disease Control and Prevention (2020). *National Diabetes Statistics Report 2020. Estimates of diabetes and its burden in the United States.* 

2.Centers for Disease Control and Prevention. (2022, December 21). *Health and economic benefits of diabetes interventions. Centers for Disease Control and Prevention.* Retrieved March 22, 2023, from https://www.cdc.gov/chronicdisease/programs-impact/pop/diabetes.html 

3. American Diabetes Association | ADA. (n.d.). *The cost of diabetes.* Retrieved March 22, 2023, from https://diabetes.org/about-us/statistics/cost-diabetes 

4. Teboul, A. (2021, November 8). *Diabetes health indicators dataset.* Kaggle. Retrieved March 22, 2023, from https://www.kaggle.com/datasets/alexteboul/diabetes-health-indicators-dataset?select=diabetes_012_health_indicators_BRFSS2015.csv 

5. Centers for Disease Control and Prevention. (2022, July 7). *What is diabetes?* Centers for Disease Control and Prevention. Retrieved March 22, 2023, from https://www.cdc.gov/diabetes/basics/diabetes.html 